import{d as e,a}from"./@vue.runtime-dom-c19fd55a.js";import{_ as s}from"./logo-0740f7d8.js";import{u as o}from"./index-9d3f82e1.js";import"./vue-echarts-85a407f1.js";import{a as r}from"./element-plus-3d06375f.js";import"./store-96e17a43.js";import{u as t}from"./index-c9cbb650.js";import{d as l,e as d,o as i,c as p,R as n,a as c,b as m,J as u,K as f,N as v,al as j,ak as h}from"./@vue.runtime-core-4f5b9f62.js";import{e as b,h as g,u as y}from"./@vue.reactivity-bec702f3.js";import{_}from"./_plugin-vue_export-helper-c4cb8a60.js";import{L as w}from"./@vue.shared-5670d8a7.js";import"./axios-966d6f38.js";import"./nprogress-6d1393d1.js";import"./lodash-es-a085e596.js";import"./vue-router-18ffceba.js";import"./pinia-dbeeb1e2.js";import"./vue-demi-5b9a0fa5.js";import"./@vueuse.core-d0bf94bd.js";import"./@vueuse.shared-3f1de09b.js";import"./vue-2b98d5da.js";import"./mockjs-93ca2bc8.js";import"./mitt-dab1f1cb.js";import"./@element-plus.icons-vue-c0c6c02f.js";import"./@popperjs.core-040feab9.js";import"./@ctrl.tinycolor-84ad98d6.js";import"./dayjs-dd470533.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui.dom-9d85c32a.js";import"./@floating-ui.core-c56fb7e8.js";import"./resize-detector-94afada7.js";import"./echarts-33de40b3.js";import"./tslib-ed971494.js";import"./zrender-d158d5d4.js";const x=["innerHTML"],k=["src"],C=l({name:"undefined"}),V=_(l({...C,emits:["update:modelValue","change"],setup(e,{expose:a,emit:s}){const{service:o}=t(),l=b(""),n=b("");function c(){o.base.open.captcha({height:40,width:150}).then((({captchaId:e,data:a})=>{a.includes(";base64,")?l.value=a:n.value=a,s("update:modelValue",e),s("change",{base64:l,svg:n,captchaId:e})})).catch((e=>{r.error(e.message)}))}return d((()=>{c()})),a({refresh:c}),(e,a)=>(i(),p("div",{class:"captcha",onClick:c},[n.value?(i(),p("div",{key:0,class:"svg",innerHTML:n.value},null,8,x)):(i(),p("img",{key:1,class:"base64",src:l.value,alt:""},null,8,k))]))}}),[["__scopeId","data-v-63c69ae6"]]),I=e=>(j("data-v-96addf8f"),e=e(),h(),e),z={class:"page-login"},L={class:"box"},T={class:"logo"},U=I((()=>c("img",{src:s,alt:"Logo"},null,-1))),K=I((()=>c("p",{class:"desc"},"一款快速開發後臺權限管理系統",-1))),H={class:"row"},M=["onKeyup"],R={class:"op"},J=l({name:"login"}),N=_(l({...J,setup(s){const{refs:l,setRefs:d,router:j,service:h}=t(),{user:_,app:x}=o(),k=b(!1),C=g({username:"",password:"",captchaId:"",verifyCode:""});async function I(){if(!C.username)return r.error("用戶名不能為空");if(!C.password)return r.error("密碼不能為空");if(!C.verifyCode)return r.error("圖片驗證碼不能為空");k.value=!0;try{await h.base.open.login(C).then((e=>{_.setToken(e)})),await Promise.all(x.events.hasToken.map((e=>e()))),j.push("/")}catch(e){l.value.captcha.refresh(),r.error(e.message)}k.value=!1}return(s,o)=>{const r=n("el-form-item"),t=n("el-button"),l=n("el-form");return i(),p("div",z,[c("div",L,[c("div",T,[U,c("span",null,w(y(x).info.name),1)]),K,m(l,{"label-position":"top",class:"form",disabled:k.value,size:"large"},{default:u((()=>[m(r,{label:"用戶名"},{default:u((()=>[f(c("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>C.username=e),placeholder:"請輸入用戶名",maxlength:"20",autocomplete:"on"},null,512),[[e,C.username]])])),_:1}),m(r,{label:"密碼"},{default:u((()=>[f(c("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>C.password=e),type:"password",placeholder:"請輸入密碼",maxlength:"20",autocomplete:"off"},null,512),[[e,C.password]])])),_:1}),m(r,{label:"驗證碼"},{default:u((()=>[c("div",H,[f(c("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>C.verifyCode=e),placeholder:"圖片驗證碼",maxlength:"4",onKeyup:a(I,["enter"])},null,40,M),[[e,C.verifyCode]]),m(V,{ref:y(d)("captcha"),modelValue:C.captchaId,"onUpdate:modelValue":o[3]||(o[3]=e=>C.captchaId=e),onChange:o[4]||(o[4]=()=>{C.verifyCode=""})},null,8,["modelValue"])])])),_:1}),c("div",R,[m(t,{round:"",loading:k.value,onClick:I},{default:u((()=>[v("登錄")])),_:1},8,["loading"])])])),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-96addf8f"]]);export{N as default};
