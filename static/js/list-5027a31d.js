import{i as e,e as l,d as a}from"./index-3a23732c.js";import"./vue-echarts-85a407f1.js";import{a as t,b as r}from"./element-plus-f16307a8.js";import{u as o}from"./index-538f59ff.js";import{v as s}from"./@vue.runtime-dom-c19fd55a.js";import"./store-96e17a43.js";import{S as i}from"./@element-plus.icons-vue-c0c6c02f.js";import{d as n,y as d,e as p,R as u,Y as c,K as m,o as f,c as b,a as v,I as h,J as y,N as j,b as g,F as x,V as k,M as w,al as _,ak as C,q as z,z as I}from"./@vue.runtime-core-4f5b9f62.js";import{e as W,u as q}from"./@vue.reactivity-bec702f3.js";import{o as N,L as T}from"./@vue.shared-5670d8a7.js";import{_ as F}from"./_plugin-vue_export-helper-c4cb8a60.js";import{q as R}from"./lodash-es-a085e596.js";import"./axios-966d6f38.js";import"./nprogress-6d1393d1.js";import"./vue-router-18ffceba.js";import"./pinia-dbeeb1e2.js";import"./vue-demi-5b9a0fa5.js";import"./@vueuse.core-d0bf94bd.js";import"./@vueuse.shared-3f1de09b.js";import"./vue-2b98d5da.js";import"./mockjs-93ca2bc8.js";import"./mitt-dab1f1cb.js";import"./@popperjs.core-040feab9.js";import"./@ctrl.tinycolor-84ad98d6.js";import"./dayjs-dd470533.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui.dom-9d85c32a.js";import"./@floating-ui.core-c56fb7e8.js";import"./resize-detector-94afada7.js";import"./echarts-33de40b3.js";import"./tslib-ed971494.js";import"./zrender-d158d5d4.js";const E={class:"dict-group"},G={class:"head"},M=(e=>(_("data-v-4ae67d6f"),e=e(),C(),e))((()=>v("span",null,"类型",-1))),K={class:"list"},S=["onClick","onContextmenu"],U=n({name:"undefined"}),A=F(n({...U,setup(a){const{service:n}=o(),_=e.exports.useForm(),C=d("dict"),z=W(""),I=W([]),F=W(!1),R=d("viewGroup");async function U(){F.value=!0,await n.dict.type.list().then((e=>{I.value=e,z.value||A(e[0])})),F.value=!1}function A(e){z.value=null==e?void 0:e.id,C.setGroup(e),C.refresh({typeId:z.value,page:1}),R.checkExpand(!1)}function D(e){var l;null==(l=_.value)||l.open({title:e?"編輯类型":"添加类型",width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}],form:{...e},on:{submit(l,{close:a,done:r}){n.dict.type[e?"update":"add"](l).then((()=>{t.success("保存成功"),a(),U()})).catch((e=>{t.error(e.message),r()}))}}})}return p((()=>{U()})),(a,o)=>{const d=u("el-button"),p=u("el-icon"),C=u("el-empty"),W=u("el-scrollbar"),R=u("cl-form"),J=c("permission"),L=c("loading");return m((f(),b("div",E,[v("div",G,[M,m((f(),h(d,{type:"success",bg:"",size:"small",onClick:o[0]||(o[0]=e=>D())},{default:y((()=>[j("添加")])),_:1})),[[J,q(n).dict.type.permission.add]])]),v("div",K,[g(W,null,{default:y((()=>[v("ul",null,[(f(!0),b(x,null,k(I.value,((a,o)=>(f(),b("li",{key:o,class:N(["item",{"is-active":z.value==a.id}]),onClick:e=>A(a),onContextmenu:o=>{!function(a,o){e.exports.ContextMenu.open(a,{hover:{target:"item"},list:[{label:"編輯",hidden:!l(n.dict.type.permission.update),callback(e){e(),D(o)}},{label:"刪除",hidden:!l(n.dict.type.permission.delete),callback(e){e(),r.confirm("是否要刪除该类型？","提示",{type:"warning"}).then((()=>{n.dict.type.delete({ids:[o.id]}).then((async()=>{t.success("刪除成功"),await U(),z.value==o.id&&A(I.value[0])})).catch((e=>{t.error(e.message)}))})).catch((()=>null))}}]})}(o,a)}},[v("span",null,T(a.name)+" - "+T(a.key),1),m(g(p,null,{default:y((()=>[g(q(i))])),_:2},1536),[[s,z.value==a.id]])],42,S)))),128)),0==I.value.length?(f(),h(C,{key:0,"image-size":80})):w("",!0)])])),_:1})]),g(R,{ref_key:"Form",ref:_},null,512)])),[[L,F.value]])}}}),[["__scopeId","data-v-4ae67d6f"]]),D=n({name:"dict-list"}),J=n({...D,setup(l){const{service:t}=o(),r=W(),s=z((()=>r.value?`字典列表（${r.value.name}）`:"字典列表")),i=e.exports.useUpsert({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上級節點",prop:"parentId",component:{name:"el-tree-select",props:{data:z((()=>{var e;const l=R(null==(e=n.value)?void 0:e.data);return function e(l,a){var t;l.id&&l.id==(null==(t=i.value)?void 0:t.getForm("id"))&&(a=!0),a&&(l.disabled=!0),l.children&&l.children.forEach((l=>{e(l,a)}))}({children:l},!1),l})),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名稱",prop:"name",required:!0,component:{name:"el-input"}},{label:"類型",prop:"type",component:{name:"el-select",options:[{label:"一般",value:null},{label:"灰階",value:"info"},{label:"警告",value:"warning"},{label:"危險",value:"danger"},{label:"成功",value:"success"}]}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"備註",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:l}){l({...e,typeId:r.value.id})}}),n=e.exports.useTable({contextMenu:["refresh",e=>{var l;return{label:"新增",hidden:!(null==(l=t.dict.info._permission)?void 0:l.add),callback(l){b(e),l()}}},"edit","delete","order-asc","order-desc"],columns:[{type:"selection",width:60},{label:"ID",prop:"id",width:60},{label:"類型",prop:"type",minWidth:100,dict:[{label:"一般",value:null},{label:"灰階",value:"info",type:"info"},{label:"警告",value:"warning",type:"warning"},{label:"危險",value:"danger",type:"danger"},{label:"成功",value:"success",type:"success"}]},{label:"名稱",prop:"name",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"custom",width:100},{label:"備註",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"創建時間",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新時間",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),d=e.exports.useCrud({service:t.dict.info,onRefresh(e,{render:l}){var o;t.dict.info.list({typeId:null==(o=r.value)?void 0:o.id,...e,page:void 0,size:void 0}).then((e=>{l(a(e))}))}});function p(e,l){var a;(null==l?void 0:l.property)&&e.children&&(null==(a=n.value)||a.toggleRowExpansion(e))}function b(e){var l;null==(l=d.value)||l.rowAppend({parentId:e.id,orderNum:1})}return I("dict",{group:r,refresh:function(e){var l;null==(l=d.value)||l.refresh(e)},setGroup:function(e){r.value=e}}),(e,l)=>{const a=u("cl-refresh-btn"),o=u("cl-add-btn"),v=u("cl-flex1"),x=u("cl-search-key"),k=u("el-row"),w=u("el-button"),_=u("cl-table"),C=u("cl-upsert"),z=u("cl-crud"),I=u("cl-view-group"),W=c("permission");return f(),h(I,{title:q(s)},{left:y((()=>[g(A)])),right:y((()=>[g(z,{ref_key:"Crud",ref:d},{default:y((()=>[g(k,null,{default:y((()=>[g(a),g(o,{disabled:!r.value},null,8,["disabled"]),g(v),g(x)])),_:1}),g(k,null,{default:y((()=>[g(_,{ref_key:"Table",ref:n,"default-sort":{prop:"orderNum",order:"ascending"},"row-key":"id",onRowClick:p},{"slot-btn":y((({scope:e})=>[m((f(),h(w,{text:"",bg:"",type:"success",onClick:l=>b(e.row)},{default:y((()=>[j("新增")])),_:2},1032,["onClick"])),[[W,q(t).dict.info.permission.add]])])),_:1},512)])),_:1}),g(k,null,{default:y((()=>[g(v)])),_:1}),g(C,{ref_key:"Upsert",ref:i},null,512)])),_:1},512)])),_:1},8,["title"])}}});export{J as default};
